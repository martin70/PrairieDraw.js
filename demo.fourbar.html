<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">
<title>Four Bar Example</title>
<script src="sylvester.js"></script>
<script src="PrairieDraw.js"></script>
<style>
canvas {
    border: 1px solid black;
}
</style>
</head>

<body>

<canvas id="fourbar" width="400" height="400"></canvas>
<script type="application/javascript">
var omega = 1;
var length_bar1 = 1;
var length_bar2 = 26/18;
var length_bar3 = 2;
var length_base = 40/18;

animPD = new PrairieDrawAnim("fourbar", function(t) {
	//SET UP PRAIRIEDRAW
	this.setUnits(6, 6);
	this.setProp("arrowLineWidthPx",2);
	
	//LENGTH AND ANGLE CALCULATIONS
	var A = t*omega; //"theta"
	var AD = length_bar1; //length of left bar
	var AB = length_base; //distance between two stationary pivots
	var BC = length_bar3; //length of right bar
	var CD = length_bar2; //length of middle bar
	var BD = Math.sqrt(AD*AD + AB*AB - 2*AD*AB*Math.cos(A));
	var C = Math.acos((BC*BC + CD*CD - BD*BD)/(2*BC*CD));
	var ABD = Math.asin(CD * Math.sin(C) / BD);
	var DBC = Math.asin(AD * Math.sin(A) / BD);
	var B = ABD + DBC;
	var D = Math.PI - B - C;
	
	//DRAW GROUND
	var G = $V([0, -0.5]);
	this.ground(G, $V([0, 1]), 10);
	
	//DRAW PIVOTS
	var pivot_left = $V([AB/-2, 0]);
	var pivot_right = $V([AB/2, 0]);
	this.pivot($V([pivot_left.e(1), -0.5]), pivot_left, 0.5);
	this.pivot($V([pivot_right.e(1), -0.5]), pivot_right, 0.5);

	//FIRST BAR
	this.translate(pivot_left);
	this.rotate(A);
	this.rod($V([0,0]), $V([AD,0]), 0.25);
	this.point($V([0,0]));

	//SECOND BAR
	this.translate($V([AD,0]));
	this.rotate(A*-1); 	//"undo" the original A rotation
	this.rotate(D);		//rotate by D only
	this.rod($V([0,0]), $V([CD,0]), 0.25);
	this.point($V([0,0]));
	
	//THIRD BAR
	this.translate($V([CD,0]));
	this.rotate(Math.PI+C);
	this.rod($V([0,0]), $V([BC,0]), 0.25);
	this.point($V([0,0]));
	this.point($V([BC,0]));
});

function setOmega(value){
	omega = document.getElementById('omegaslider').value;
}

function setBar1(value){
	length_bar1 = document.getElementById('bar1slider').value;
}

function setBar2(value){
	length_bar2 = document.getElementById('bar2slider').value;
}

function setBar3(value){
	length_bar3 = document.getElementById('bar3slider').value;
}

function setBase(value){
	length_base = document.getElementById('baseslider').value;
}

</script>
<p>
Omega: <input id="omegaslider" type="range" min="-3" max="3" value="0" step="0.2" onchange=setOmega()><p>
Left: <input id="bar1slider" type="range" min="0" max="4" value="1" step="0.2" onchange=setBar1()>
Middle: <input id="bar2slider" type="range" min="0" max="4" value="26/18" step="0.2" onchange=setBar2()>
Right: <input id="bar3slider" type="range" min="0" max="4" value="2" step="0.2" onchange=setBar3()>
Base: <input id="baseslider" type="range" min="0" max="4" value="40/18" step="0.2" onchange=setBase()><p>
<button onclick="animPD.toggleAnim();">Toggle animation</button>
<p>



</body>